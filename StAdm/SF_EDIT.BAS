10 CLS
20 OPEN "I",#1,"ADM.SEQ"
30 OPEN "O",#2,"EADM.SEQ"
40 LOCATE 10,29 : PRINT STRING$(21,".")
50 LOCATE 11,29 : PRINT "."
60 LOCATE 11,49 : PRINT "."
70 LOCATE 12,29 : PRINT "."
80 LOCATE 12,49 : PRINT "."
90 LOCATE 13,29 : PRINT "."
100 LOCATE 13,49 : PRINT "."
110 LOCATE 14,29 : PRINT STRING$(21,".")
120 LOCATE 11,31 : PRINT "ENTER ROLL NUMBER"
130 LOCATE 13,37 : INPUT "" , R$
140 WHILE EOF(1) =0
150 INPUT #1,N$,DOB$,RN$,F$,M$,ADM$,C$,S$,G$,NICF$,NICM$,GD$,POB$,NAT$,RG$,FOC$,ADD$,MOB$,TEL$,ADF%,EM$
160 IF R$ = RN$ THEN GOTO 210 ELSE GOTO 170
170 WRITE #2,N$,DOB$,RN$,F$,M$,ADM$,C$,S$,G$,NICF$,NICM$,GD$,POB$,NAT$,RG$,FOC$,ADD$,MOB$,TEL$,ADF%,EM$
180 WEND
190 CLOSE #1 : CLOSE #2 : KILL "ADM.SEQ"
200 NAME "EADM.SEQ" AS "ADM.SEQ" : END
210  CLS : LOCATE 1,34 : PRINT "SAF COLLEGIATE"
220 LOCATE 2,34 : PRINT "=============="
230 LOCATE 3,28 : PRINT "STUDENT'S ADMISSION DETAIL"
240 LOCATE 5,2 : PRINT "STUDENT NAME :" : LOCATE 5,16 : PRINT N$
250 LOCATE 5,35 : PRINT "DATE OF BIRTH :" : LOCATE 5,50 : PRINT DOB$
260 LOCATE 5,64 : PRINT "ROLL NO. :" : LOCATE 5,74 : PRINT RN$
270 LOCATE 7,8 : PRINT "FATHER NAME :" : LOCATE 7,21 : PRINT F$
280 LOCATE 7,51 : PRINT "MOTHER NAME :" : LOCATE 7,64 : PRINT M$
290 LOCATE 9,2 : PRINT "ADMISSION DATE :" : LOCATE 9,18 : PRINT ADM$
300 LOCATE 9,31 : PRINT "CLASS :" : LOCATE 9,38 : PRINT C$
310 LOCATE 9,43 : PRINT "SECTION :" : LOCATE 9,52 : PRINT S$
320 LOCATE 9,57 : PRINT "GROUP :" : LOCATE 9,64 : PRINT G$
330 LOCATE 11,2 : PRINT "FATHER NIC :" : LOCATE 11,14 : PRINT NICF$
340 LOCATE 11,33 : PRINT "MOTHER NIC :" :LOCATE 11,45 : PRINT NICM$
350 LOCATE 11,64 : PRINT "GENDER :" : LOCATE 11,72 : PRINT GD$
360 LOCATE 13,2 : PRINT "PLACE OF BIRTH :" :LOCATE 13,18 : PRINT POB$
370 LOCATE 13,35 : PRINT "NATIONALITY :" : LOCATE 13,48 : PRINT NAT$
380 LOCATE 13,60 : PRINT "RELIGION :" : LOCATE 13,70 : PRINT RG$
390 LOCATE 15,2 : PRINT "FATHER OCCUPATION :" : LOCATE 15,21 : PRINT FOC$
400 LOCATE 17,2 : PRINT "ADDRESS :" : LOCATE 17,11 : PRINT ADD$
410 LOCATE 19,2 : PRINT "MOBILE :" : LOCATE 19,10 : PRINT MOB$
420 LOCATE 19,28 : PRINT "TELEPHONE :" : LOCATE 19,39 : PRINT TEL$
430 LOCATE 19,57 : PRINT "ADMISSION FEE :" : LOCATE 19,72 : PRINT ADF%
440 LOCATE 21,22 : PRINT "EMAIL :" : LOCATE 21,29 : PRINT EM$
450 LOCATE 5,16 : INPUT "" , EN$
460 IF EN$ = "" THEN EN$ = N$
470 LOCATE 5,50 : INPUT "" , EDOB$
480 IF EDOB$ = "" THEN EDOB$ = DOB$ ELSE GOTO 1440
490 LOCATE 23,5 : PRINT SPACE$(75)
500 LOCATE 5,74 : INPUT "" , ERN$
510 IF ERN$ = "" THEN ERN$ = RN$
520 OPEN "I" ,#3,"ADM.SEQ"
525 IF ERN$ = RN$ THEN GOTO 570 
530 WHILE EOF(3) = 0
540 INPUT #3,SNAME$,DAT$,ROLL$,FAT$,MOM$,ADATE$,CLASS$,SEC$,GRP$,NICFAT$,NICMOM$,GEN$,PLACE$,NATIO$,RELI$,FATOCC$,ADDRE$,MOBN$,TELEN$,FEE%,MAIL$
550 IF ERN$ = ROLL$ THEN BEEP : CLOSE #3 :LOCATE 23,22: PRINT "Duplicate Roll Number Found!" :  GOTO 500
560 WEND 
570 CLOSE #3: LOCATE 23,22: PRINT SPACE$(40)
580 LOCATE 7,21 : INPUT "" , EF$
590 IF EF$ = "" THEN EF$ = F$
600 LOCATE 7,64 : INPUT "" , EM$
610 IF EM$ = "" THEN EM$ = M$
620 LOCATE 9,18 : INPUT "" , EADM$
630 IF EADM$ = "" THEN EADM$ =ADM$ ELSE GOTO 1730
640 LOCATE 23,5 : PRINT SPACE$(75)
650 LOCATE 9,38 : INPUT "" , EC$
660 IF EC$ = "" THEN EC$ = C$
670 LOCATE 9,52 : INPUT "" , ES$
680 IF ES$ = "" THEN ES$ = S$
690 LOCATE 9,64 : INPUT "" , EG$
700 IF EG$ = "" THEN EG$ = G$
710 LOCATE 11,14 : INPUT "" , ENICF$
720 IF ENICF$ = "" THEN ENICF$ = NICF$ ELSE GOTO 940
730 LOCATE 23,22 : PRINT SPACE$(45)
740 LOCATE 11,45 : INPUT "" , ENICM$
750 IF ENICM$ = "" THEN ENICM$ = NICM$ ELSE GOTO 1190
760 LOCATE 23,22 : PRINT SPACE$(45)
770 LOCATE 11,72 : INPUT "" ,EGD$
780 IF EGD$ = "" THEN EGD$ = GD$
790 LOCATE 13,18 : INPUT "" ,EPOB$ : IF EPOB$ = "" THEN EPOB$ = POB$
800 LOCATE 13,48 : INPUT "" , ENAT$ : IF ENAT$ = "" THEN ENAT$ = NAT$
810 LOCATE 13,70 : INPUT "" , ERG$  
820 IF ERG$ = "" THEN ERG$ = RG$
830 LOCATE 15,21 : INPUT "" , EFOC$
840 IF EFOC$ = "" THEN EFOC$ = FOC$
850 LOCATE 17,11 : INPUT "" , EADD$
860 IF EADD$ = "" THEN EADD$ = ADD$
870 LOCATE 19,10 : INPUT "" , EMOB$
880 IF EMOB$ = "" THEN EMOB$ = MOB$
890 LOCATE 19,39 : INPUT "" , ETEL$
900 IF ETEL$ = "" THEN ETEL$ = TEL$
910 LOCATE 19,72 : INPUT "" , EADF%
920 IF EADF% = 0 THEN EADF% = ADF%
930 LOCATE 21,29 : INPUT "" , EEM$ : IF EEM$ = "" THEN EEM$ = EM$ : GOTO 2020 ELSE GOTO 2020 
940 LOCATE 23,22 : PRINT SPACE$(40) : L = LEN(ENICF$)
950 IF L = 15 THEN GOTO 980 ELSE GOTO 960
960 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. INVALID LENGTH"
970 GOTO 710
980 IF MID$(ENICF$,7,1) = "-" THEN GOTO 1010 ELSE GOTO 990
990 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 7TH POSITION MUST BE -" 
1000 GOTO 710
1010 IF MID$(ENICF$,14,1) = "-" THEN GOTO 1040 ELSE GOTO 1020
1020 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 14TH POSITION MUST BE -" 
1030 GOTO 710
1040 IF ASC(RIGHT$(ENICF$,1)) >=48 AND ASC(RIGHT$(ENICF$,1)) <=57 THEN GOTO 1070 ELSE GOTO 1050
1050 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. LAST CHARACTER MUST BE A DIGIT" 
1060 GOTO 710
1070 FOR P = 1 TO 6
1080 IF ASC(MID$(ENICF$,P,1)) >=48 AND ASC(MID$(ENICF$,P,1)) <=57 THEN GOTO 1090 ELSE GOTO 1110
1090 NEXT P
1100 GOTO 1130
1110 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. FIRST SIX CHARACTERS MUST BE DIGITS"
1120 GOTO 710
1130 FOR P = 8 TO 13
1140 IF ASC(MID$(ENICF$,P,1)) >=48 AND ASC(MID$(ENICF$,P,1)) <=57 THEN GOTO 1150 ELSE GOTO 1170
1150 NEXT P
1160 GOTO 730
1170 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. POSITION 8 TO 13 MUST BE DIGITS" 
1180 GOTO 710
1190 LOCATE 23,22 : PRINT SPACE$(40) : L = LEN(ENICF$)
1200 IF L = 15 THEN GOTO 1230 ELSE GOTO 1210
1210 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. INVALID LENGTH" 
1220 GOTO 740
1230 IF MID$(ENICF$,7,1) = "-" THEN GOTO 1260 ELSE GOTO 1240
1240 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 7TH POSITION MUST BE -" 
1250 GOTO 740
1260 IF MID$(ENICF$,14,1) = "-" THEN GOTO 1290 ELSE GOTO 1270
1270 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 14TH POSITION MUST BE -" 
1280 GOTO 740
1290 IF ASC(RIGHT$(ENICF$,1)) >=48 AND ASC(RIGHT$(ENICF$,1)) <=57 THEN GOTO 1320 ELSE GOTO 1300
1300 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. LAST CHARACTER MUST BE A DIGIT" 
1310 GOTO 740
1320 FOR P = 1 TO 6
1330 IF ASC(MID$(ENICF$,P,1)) >=48 AND ASC(MID$(ENICF$,P,1)) <=57 THEN GOTO 1340 ELSE GOTO 1360
1340 NEXT P
1350 GOTO 1380
1360 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. FIRST SIX CHARACTERS MUST BE DIGITS" 
1370 GOTO 740
1380 FOR P = 8 TO 13
1390 IF ASC(MID$(ENICF$,P,1)) >=48 AND ASC(MID$(ENICF$,P,1)) <=57 THEN GOTO 1400 ELSE GOTO 1420
1400 NEXT P
1410 GOTO 760
1420 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. POSITION 8 TO 13 MUST BE DIGITS" 
1430 GOTO 740
1440 LOCATE 23,5 : PRINT SPACE$(75) : L = LEN(EDOB$)
1450 IF L = 10 THEN GOTO 1470 ELSE GOTO 1460 
1460 LOCATE 23,22 : PRINT "INVALID DATE LENGTH" : LOCATE 5,50 : PRINT SPACE$(11) : GOTO 470
1470 IF MID$(EDOB$,3,1) = "/" OR MID$(EDOB$,3,1) = "-" THEN GOTO 1480 ELSE GOTO 1490
1480 IF MID$(EDOB$,6,1) = "/" OR MID$(EDOB$,6,1) = "-" THEN GOTO 1500 ELSE GOTO 1490
1490 LOCATE 23,22 : PRINT "3RD AND 6TH POSITION IN DATE MUST CONTAIN (/) / (-)  " : LOCATE 5,50 : PRINT SPACE$(11) :GOTO 470
1500 MON$ = MID$(EDOB$,4,2)
1510 M = VAL(MON$)
1520 IF M >=1 AND M <=12 THEN GOTO 1540 ELSE GOTO 1530
1530 LOCATE 23,22 : PRINT "YOU ENTERED INVALID MONTH" :LOCATE 5,50 : PRINT SPACE$(11) : GOTO 470
1540 YR$ = RIGHT$(EDOB$,4)
1550 Y = VAL(YR$)
1560 IF Y >=1945 AND Y <= 2050 THEN GOTO 1580 ELSE GOTO 1570
1570 LOCATE 23,22 : PRINT "YOU ENTERED INVALID YEAR. ALLOWED ONLY 1800-2050 ":GOTO 470
1580 DAT$ = LEFT$(EDOB$,2)
1590 D = VAL(DAT$)
1600 IF M = 4 OR M = 6 OR M = 9 OR M = 11 THEN GOTO 1630 ELSE GOTO 1610
1610 IF M = 1 OR M = 3 OR M = 5 OR M = 7 OR M = 8 OR M = 10 OR M = 12 THEN GOTO 1640 ELSE GOTO 1620
1620 IF M = 2 THEN GOTO 1650
1630 IF D >= 1 AND D <= 30 THEN GOTO 1720 ELSE GOTO 1680
1640 IF D >= 1 AND D <= 31 THEN GOTO 1720 ELSE GOTO 1690
1650 LREM=Y MOD 4: IF LREM = 0 THEN GOTO 1660 ELSE GOTO 1670
1660 IF D >= 1 AND D <= 29 THEN GOTO 1720 ELSE GOTO 1700
1670 IF D >= 1 AND D <= 28 THEN GOTO 1720 ELSE GOTO 1710
1680 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 30 DAYS FOR THE MONTHS 4,6,9 & 11":GOTO 470
1690 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 31 DAYS FOR THE MONTHS 1,3,5,7,8,10 & 12":GOTO 470
1700 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 29 DAYS FOR THE MONTH LEAP YEAR 2":GOTO 470
1710 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 28 DAYS FOR THE MONTH 2":GOTO 470
1720 GOTO 490
1730 LOCATE 23,5 : PRINT SPACE$(75) : L = LEN(EADM$)
1740 IF L = 10 THEN GOTO 1760 ELSE GOTO 1750 
1750 LOCATE 23,22 : PRINT "INVALID DATE LENGTH" : GOTO 620
1760 IF MID$(EADM$,3,1) = "/" OR MID$(EADM$,3,1) = "-" THEN GOTO 1770 ELSE GOTO 1780
1770 IF MID$(EADM$,6,1) = "/" OR MID$(EADM$,6,1) = "-" THEN GOTO 1790 ELSE GOTO 1780
1780 LOCATE 23,20 : PRINT "3RD AND 6TH POSITION IN DATE MUST CONTAIN (/) / (-)  " : GOTO 620
1790 MON$ = MID$(EADM$,4,2)
1800 M = VAL(MON$)
1810 IF M >=1 AND M <=12 THEN GOTO 1830 ELSE GOTO 1820
1820 LOCATE 23,22 : PRINT "YOU ENTERED INVALID MONTH" : GOTO 620
1830 YR$ = RIGHT$(EADM$,4)
1840 Y = VAL(YR$)
1850 IF Y >=1800 AND Y <= 2050 THEN GOTO 1870 ELSE GOTO 1860
1860 LOCATE 23,22 : PRINT "YOU ENTERED INVALID YEAR. ALLOWED ONLY 1800-2050 ":GOTO 620
1870 DAT$ = LEFT$(EADM$,2)
1880 D = VAL(DAT$)
1890 IF M = 4 OR M = 6 OR M = 9 OR M = 11 THEN GOTO 1920 ELSE GOTO 1900
1900 IF M = 1 OR M = 3 OR M = 5 OR M = 7 OR M = 8 OR M = 10 OR M = 12 THEN GOTO 1930 ELSE GOTO 1910
1910 IF M = 2 THEN GOTO 1940
1920 IF D >= 1 AND D <= 30 THEN GOTO 2010 ELSE GOTO 1970
1930 IF D >= 1 AND D <= 31 THEN GOTO 2010 ELSE GOTO 1980
1940 LREM=Y MOD 4: IF LREM = 0 THEN GOTO 1950 ELSE GOTO 1960
1950 IF D >= 1 AND D <= 29 THEN GOTO 2010 ELSE GOTO 1990
1960 IF D >= 1 AND D <= 28 THEN GOTO 2010 ELSE GOTO 2000
1970 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 30 DAYS FOR THE MONTHS 4,6,9 & 11":GOTO 620
1980 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 31 DAYS FOR THE MONTHS 1,3,5,7,8,10 & 12":GOTO 620
1990 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 29 DAYS FOR THE MONTH LEAP YEAR 2":GOTO 620
2000 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 28 DAYS FOR THE MONTH 2":GOTO 620
2010 GOTO 640
2020 LOCATE 23,22 : PRINT "DO YOU WANT TO UPDATE THE RECORD (Y/N)" 
2030 LOCATE 23,67 : INPUT "" , OPT$
2040 IF OPT$ =  "Y" THEN GOTO 2060
2050 IF OPT$ = "N" THEN GOTO 170
2060 WRITE #2 ,EN$,EDOB$,ERN$,EF$,EM$,EADM$,EC$,ES$,EG$,ENICF$,ENICM$,EGD$,EPOB$,ENAT$,ERG$,EFOC$,EADD$,EMOB$,ETEL$,EADF%,EEM$
2070 GOTO 180
