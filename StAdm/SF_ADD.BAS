10 CLS
20 REM "PROGRAM TO ADD ADMISSION DETAIL OF STUDENTS"
30 OPEN "A",#1,"ADM.SEQ"
40 LOCATE 1,34 : PRINT "SAF COLLEGIATE"
50 LOCATE 2,34 : PRINT "=============="
60 LOCATE 3,28 : PRINT "STUDENT'S ADMISSION DETAIL"
70 LOCATE 5,2 : PRINT "STUDENT NAME :"
80 LOCATE 5,35 : PRINT "DATE OF BIRTH :"
90 LOCATE 5,64 : PRINT "ROLL NO. :"
100 LOCATE 7,8 : PRINT "FATHER NAME :"
110 LOCATE 7,51 : PRINT "MOTHER NAME :"
120 LOCATE 9,2 : PRINT "ADMISSION DATE :"
130 LOCATE 9,31 : PRINT "CLASS :"
140 LOCATE 9,43 : PRINT "SECTION :"
150 LOCATE 9,57 : PRINT "GROUP :"
160 LOCATE 11,2 : PRINT "FATHER NIC :"
170 LOCATE 11,33 : PRINT "MOTHER NIC :"
180 LOCATE 11,64 : PRINT "GENDER :"
190 LOCATE 13,2 : PRINT "PLACE OF BIRTH :"
200 LOCATE 13,35 : PRINT "NATIONALITY :"
210 LOCATE 13,60 : PRINT "RELIGION :"
220 LOCATE 15,2 : PRINT "FATHER OCCUPATION :"
230 LOCATE 17,2 : PRINT "ADDRESS :"
240 LOCATE 19,2 : PRINT "MOBILE :"
250 LOCATE 19,28 : PRINT "TELEPHONE :"
260 LOCATE 19,57 : PRINT "ADMISSION FEE :"
270 LOCATE 21,22 : PRINT "EMAIL :"
280 LOCATE 5,16 : INPUT "" , N$
290 IF N$ = "" THEN BEEP : GOTO 280
300 LOCATE 5,50 : PRINT SPACE$(11) : LOCATE 5,50 : INPUT "" , DOB$
310 IF DOB$ = "" THEN BEEP : GOTO 300 ELSE GOTO 1360
320 LOCATE 23,5 : PRINT SPACE$(75)
330 LOCATE 5,74 : INPUT "" , RN$
340 IF RN$ = "" THEN BEEP : GOTO 330
350 OPEN "I" ,#2,"ADM.SEQ"
360 WHILE EOF(2) = 0
370 INPUT #2,SNAME$,DAT$,ROLL$,FAT$,MOM$,ADATE$,CLASS$,SEC$,GRP$,NICFAT$,NICMOM$,GEN$,PLACE$,NATIO$,RELI$,FATOCC$,ADDRE$,MOBN$,TELEN$,FEE%,MAIL$
380 IF RN$ = ROLL$ THEN BEEP : CLOSE #2 :LOCATE 23,22: PRINT "Duplicate Roll Number Found!" :  GOTO 330
390 WEND 
400 CLOSE #2: LOCATE 23,22: PRINT SPACE$(40)
410 LOCATE 7,21 : INPUT "" , F$
420 IF F$ = "" THEN BEEP : GOTO 410
430 LOCATE 7,64 : INPUT "" , M$
440 IF M$ = "" THEN BEEP : GOTO 430
450 LOCATE 9,18: PRINT SPACE$(11) : LOCATE 9,18 : INPUT "" , ADM$
460 IF ADM$ = "" THEN BEEP : GOTO 450 ELSE GOTO 1650
470 LOCATE 23,5 : PRINT SPACE$(75)
480 LOCATE 9,38 : INPUT "" , C$
490 IF C$ = "" THEN BEEP : GOTO 480
500 LOCATE 9,52 : INPUT "" , S$
510 IF S$ = "" THEN BEEP : GOTO 500
520 LOCATE 9,64 : INPUT "" , G$
530 IF G$ = "" THEN BEEP : GOTO 520
540 LOCATE 11,14 : PRINT SPACE$(17) : LOCATE 11,14 : INPUT "" , NICF$
550 IF NICF$ = "" THEN BEEP : GOTO 540 ELSE GOTO 860
560 LOCATE 23,22 : PRINT SPACE$(45)
570 LOCATE 11,45 : PRINT SPACE$(17) : LOCATE 11,45 : INPUT "" , NICM$
580 IF NICM$ = "" THEN BEEP : GOTO 570 ELSE GOTO 1110
590 LOCATE 23,22 : PRINT SPACE$(45)
600 LOCATE 11,72 : INPUT "" ,GD$
610 IF GD$ = "" THEN BEEP : GOTO 600
620 LOCATE 13,18 : INPUT "" ,POB$
630 LOCATE 13,48 : INPUT "" , NAT$
640 LOCATE 13,70 : INPUT "" , RG$
650 IF RG$ = "" THEN BEEP : GOTO 640
660 LOCATE 15,21 : INPUT "" , FOC$
670 IF FOC$ = "" THEN BEEP : GOTO 660
680 LOCATE 17,11 : INPUT "" , ADD$
690 IF ADD$ = "" THEN BEEP : GOTO 680
700 LOCATE 19,10 : INPUT "" , MOB$
710 IF MOB$ = "" THEN BEEP : GOTO 700
720 LOCATE 19,39 : INPUT "" , TEL$
730 IF TEL$ = "" THEN BEEP : GOTO 720
740 LOCATE 19,72 : INPUT "" , ADF%
750 IF ADF% = 0 THEN BEEP : GOTO 740
760 LOCATE 21,29 : INPUT "" , EM$
770 LOCATE 23,22 : PRINT "DO YOU WANT TO SAVE THE DATA (Y/N) ?" : LOCATE 23,59 : INPUT "",OPT$
780 IF OPT$ = "Y" THEN GOTO 800 ELSE GOTO 790
790 IF OPT$ = "N" THEN GOTO 840 ELSE GOTO 770
800 WRITE #1,N$,DOB$,RN$,F$,M$,ADM$,C$,S$,G$,NICF$,NICM$,GD$,POB$,NAT$,RG$,FOC$,ADD$,MOB$,TEL$,ADF%,EM$
810 LOCATE 23,22 : PRINT SPACE$(40)
820 LOCATE 23,22 : PRINT "DO YOU WANT TO START AGAIN (Y/N) ?"
830 LOCATE 23,57 : INPUT "" , ANS$
840 IF ANS$ = "Y" THEN CLOSE #1 :GOTO 10
850 IF ANS$ = "N" THEN CLOSE #1 : CLS : END
860 LOCATE 23,22 : PRINT SPACE$(40) : L = LEN(NICF$)
870 IF L = 15 THEN GOTO 900 ELSE GOTO 880
880 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. INVALID LENGTH"
890 GOTO 540
900 IF MID$(NICF$,7,1) = "-" THEN GOTO 930 ELSE GOTO 910
910 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 7TH POSITION MUST BE -" 
920 GOTO 540
930 IF MID$(NICF$,14,1) = "-" THEN GOTO 960 ELSE GOTO 940
940 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 14TH POSITION MUST BE -" 
950 GOTO 540
960 IF ASC(RIGHT$(NICF$,1)) >=48 AND ASC(RIGHT$(NICF$,1)) <=57 THEN GOTO 990 ELSE GOTO 970
970 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. LAST CHARACTER MUST BE A DIGIT" 
980 GOTO 540
990 FOR P = 1 TO 6
1000 IF ASC(MID$(NICF$,P,1)) >=48 AND ASC(MID$(NICF$,P,1)) <=57 THEN GOTO 1010 ELSE GOTO 1030
1010 NEXT P
1020 GOTO 1050
1030 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. FIRST SIX CHARACTERS MUST BE DIGITS"
1040 GOTO 540
1050 FOR P = 8 TO 13
1060 IF ASC(MID$(NICF$,P,1)) >=48 AND ASC(MID$(NICF$,P,1)) <=57 THEN GOTO 1070 ELSE GOTO 1090
1070 NEXT P
1080 GOTO 560
1090 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. POSITION 8 TO 13 MUST BE DIGITS" 
1100 GOTO 540
1110 LOCATE 23,22 : PRINT SPACE$(40) : L = LEN(NICF$)
1120 IF L = 15 THEN GOTO 1150 ELSE GOTO 1130
1130 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. INVALID LENGTH" 
1140 GOTO 570
1150 IF MID$(NICF$,7,1) = "-" THEN GOTO 1180 ELSE GOTO 1160
1160 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 7TH POSITION MUST BE -" 
1170 GOTO 570
1180 IF MID$(NICF$,14,1) = "-" THEN GOTO 1210 ELSE GOTO 1190
1190 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. 14TH POSITION MUST BE -" 
1200 GOTO 570
1210 IF ASC(RIGHT$(NICF$,1)) >=48 AND ASC(RIGHT$(NICF$,1)) <=57 THEN GOTO 1240 ELSE GOTO 1220
1220 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. LAST CHARACTER MUST BE A DIGIT" 
1230 GOTO 570
1240 FOR P = 1 TO 6
1250 IF ASC(MID$(NICF$,P,1)) >=48 AND ASC(MID$(NICF$,P,1)) <=57 THEN GOTO 1260 ELSE GOTO 1280
1260 NEXT P
1270 GOTO 1300
1280 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. FIRST SIX CHARACTERS MUST BE DIGITS" 
1290 GOTO 570
1300 FOR P = 8 TO 13
1310 IF ASC(MID$(NICF$,P,1)) >=48 AND ASC(MID$(NICF$,P,1)) <=57 THEN GOTO 1320 ELSE GOTO 1340
1320 NEXT P
1330 GOTO 590
1340 LOCATE 23,22 : PRINT "INVALID NIC NUMBER. POSITION 8 TO 13 MUST BE DIGITS" 
1350 GOTO 570
1360 LOCATE 23,5 : PRINT SPACE$(75) : L = LEN(DOB$)
1370 IF L = 10 THEN GOTO 1390 ELSE GOTO 1380 
1380 LOCATE 23,22 : PRINT "INVALID DATE LENGTH" : GOTO 300
1390 IF MID$(DOB$,3,1) = "/" OR MID$(DOB$,3,1) = "-" THEN GOTO 1400 ELSE GOTO 1410
1400 IF MID$(DOB$,6,1) = "/" OR MID$(DOB$,6,1) = "-" THEN GOTO 1420 ELSE GOTO 1410
1410 LOCATE 23,22 : PRINT "3RD AND 6TH POSITION IN DATE MUST CONTAIN (/) / (-)  " : GOTO 300
1420 MON$ = MID$(DOB$,4,2)
1430 M = VAL(MON$)
1440 IF M >=1 AND M <=12 THEN GOTO 1460 ELSE GOTO 1450
1450 LOCATE 23,22 : PRINT "YOU ENTERED INVALID MONTH" : GOTO 300
1460 YR$ = RIGHT$(DOB$,4)
1470 Y = VAL(YR$)
1480 IF Y >=1945 AND Y <= 2050 THEN GOTO 1500 ELSE GOTO 1490
1490 LOCATE 23,22 : PRINT "YOU ENTERED INVALID YEAR. ALLOWED ONLY 1800-2050 ":GOTO 300
1500 DAT$ = LEFT$(DOB$,2)
1510 D = VAL(DAT$)
1520 IF M = 4 OR M = 6 OR M = 9 OR M = 11 THEN GOTO 1550 ELSE GOTO 1530
1530 IF M = 1 OR M = 3 OR M = 5 OR M = 7 OR M = 8 OR M = 10 OR M = 12 THEN GOTO 1560 ELSE GOTO 1540
1540 IF M = 2 THEN GOTO 1570
1550 IF D >= 1 AND D <= 30 THEN GOTO 1640 ELSE GOTO 1600
1560 IF D >= 1 AND D <= 31 THEN GOTO 1640 ELSE GOTO 1610
1570 LREM=Y MOD 4: IF LREM = 0 THEN GOTO 1580 ELSE GOTO 1590
1580 IF D >= 1 AND D <= 29 THEN GOTO 1640 ELSE GOTO 1620
1590 IF D >= 1 AND D <= 28 THEN GOTO 1640 ELSE GOTO 1630
1600 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 30 DAYS FOR THE MONTHS 4,6,9 & 11":GOTO 300
1610 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 31 DAYS FOR THE MONTHS 1,3,5,7,8,10 & 12":GOTO 300
1620 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 29 DAYS FOR THE MONTH LEAP YEAR 2":GOTO 300
1630 LOCATE 23,10 : PRINT "INVALID DATE! DATE MUST BE IN 28 DAYS FOR THE MONTH 2":GOTO 300
1640 GOTO 320
1650 LOCATE 23,5 : PRINT SPACE$(75) : L = LEN(ADM$)
1660 IF L = 10 THEN GOTO 1680 ELSE GOTO 1670 
1670 LOCATE 23,22 : PRINT "INVALID DATE LENGTH" : GOTO 450
1680 IF MID$(ADM$,3,1) = "/" OR MID$(ADM$,3,1) = "-" THEN GOTO 1690 ELSE GOTO 1700
1690 IF MID$(ADM$,6,1) = "/" OR MID$(ADM$,6,1) = "-" THEN GOTO 1710 ELSE GOTO 1700
1700 LOCATE 23,20 : PRINT "3RD AND 6TH POSITION IN DATE MUST CONTAIN (/) / (-)  " : GOTO 450
1710 MON$ = MID$(ADM$,4,2)
1720 M = VAL(MON$)
1730 IF M >=1 AND M <=12 THEN GOTO 1750 ELSE GOTO 1740
1740 LOCATE 23,22 : PRINT "YOU ENTERED INVALID MONTH" : GOTO 450
1750 YR$ = RIGHT$(ADM$,4)
1760 Y = VAL(YR$)
1770 IF Y >=1800 AND Y <= 2050 THEN GOTO 1790 ELSE GOTO 1780
1780 LOCATE 23,22 : PRINT "YOU ENTERED INVALID YEAR. ALLOWED ONLY 1800-2050 ":GOTO 450
1790 DAT$ = LEFT$(ADM$,2)
1800 D = VAL(DAT$)
1810 IF M = 4 OR M = 6 OR M = 9 OR M = 11 THEN GOTO 1840 ELSE GOTO 1820
1820 IF M = 1 OR M = 3 OR M = 5 OR M = 7 OR M = 8 OR M = 10 OR M = 12 THEN GOTO 1850 ELSE GOTO 1830
1830 IF M = 2 THEN GOTO 1860
1840 IF D >= 1 AND D <= 30 THEN GOTO 1930 ELSE GOTO 1890
1850 IF D >= 1 AND D <= 31 THEN GOTO 1930 ELSE GOTO 1900
1860 LREM=Y MOD 4: IF LREM = 0 THEN GOTO 1870 ELSE GOTO 1880
1870 IF D >= 1 AND D <= 29 THEN GOTO 1930 ELSE GOTO 1910
1880 IF D >= 1 AND D <= 28 THEN GOTO 1930 ELSE GOTO 1920
1890 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 30 DAYS FOR THE MONTHS 4,6,9 & 11":GOTO 450
1900 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 31 DAYS FOR THE MONTHS 1,3,5,7,8,10 & 12":GOTO 450
1910 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 29 DAYS FOR THE MONTH LEAP YEAR 2":GOTO 450
1920 LOCATE 23,5 : PRINT "INVALID DATE! DATE MUST BE IN 28 DAYS FOR THE MONTH 2":GOTO 450
1930 GOTO 470
